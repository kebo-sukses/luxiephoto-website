<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>LuxiePhoto - Content Manager</title>
  <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
    }
    [class*="AppHeader"] {
      background: linear-gradient(135deg, #388f6b 0%, #215c45 100%) !important;
    }
    /* Color Picker Widget Styles */
    .color-picker-widget {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 8px 0;
    }
    .color-picker-widget input[type="color"] {
      width: 50px;
      height: 40px;
      border: 2px solid #ddd;
      border-radius: 8px;
      cursor: pointer;
      padding: 2px;
    }
    .color-picker-widget input[type="text"] {
      flex: 1;
      padding: 10px 12px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-family: monospace;
      font-size: 14px;
      text-transform: uppercase;
    }
    .color-picker-widget .color-preview {
      width: 100px;
      height: 40px;
      border-radius: 8px;
      border: 2px solid #ddd;
    }
  </style>
  <script>
    window.CMS_MANUAL_INIT = true;
  </script>
</head>
<body>
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  <script>
    // Custom Color Picker Widget
    const ColorPickerControl = createClass({
      getInitialState() {
        return { value: this.props.value || '#000000' };
      },
      handleColorChange(e) {
        const value = e.target.value.toUpperCase();
        this.setState({ value });
        this.props.onChange(value);
      },
      handleTextChange(e) {
        let value = e.target.value;
        if (!value.startsWith('#')) value = '#' + value;
        value = value.toUpperCase();
        if (/^#[0-9A-F]{6}$/i.test(value)) {
          this.setState({ value });
          this.props.onChange(value);
        } else {
          this.setState({ value: e.target.value.toUpperCase() });
        }
      },
      render() {
        const value = this.state.value || '#000000';
        return h('div', { className: 'color-picker-widget' },
          h('input', {
            type: 'color',
            value: value,
            onChange: this.handleColorChange
          }),
          h('input', {
            type: 'text',
            value: value,
            onChange: this.handleTextChange,
            placeholder: '#000000',
            maxLength: 7
          }),
          h('div', {
            className: 'color-preview',
            style: { backgroundColor: value }
          })
        );
      }
    });

    const ColorPickerPreview = createClass({
      render() {
        return h('div', {
          style: {
            backgroundColor: this.props.value || '#000000',
            width: '100px',
            height: '30px',
            borderRadius: '4px',
            display: 'inline-block'
          }
        });
      }
    });

    CMS.registerWidget('color', ColorPickerControl, ColorPickerPreview);

    CMS.init({
      config: {
        load_config_file: false,
        backend: {
          name: 'github',
          repo: 'kebo-sukses/luxiephoto-website',
          branch: 'main',
          base_url: 'https://dancing-squirrel-226937.netlify.app',
          auth_endpoint: '/.netlify/functions/auth'
        },
        media_folder: 'public/image',
        public_folder: '/image',
        logo_url: '/logo/Gold-Logo.webp',
        site_url: 'https://luxiephoto.com',
        display_url: 'https://luxiephoto.com',
        slug: {
          encoding: 'ascii',
          clean_accents: true,
          sanitize_replacement: '-'
        },
        collections: [
          {
            name: 'settings',
            label: 'âš™ï¸ Site Settings',
            files: [
              {
                name: 'general',
                label: 'General Settings',
                file: 'content/settings/general.json',
                fields: [
                  { name: 'siteName', label: 'Site Name', widget: 'string', default: 'LuxiePhoto' },
                  { name: 'logoLight', label: 'Logo (Light/White - untuk header gelap)', widget: 'image', hint: 'Logo putih untuk header transparan (sebelum scroll)' },
                  { name: 'logoDark', label: 'Logo (Dark/Black - untuk header terang)', widget: 'image', hint: 'Logo hitam untuk header putih (setelah scroll)' },
                  { name: 'logoFooter', label: 'Logo (Footer)', widget: 'image', required: false, hint: 'Logo untuk footer (opsional)' },
                  { name: 'favicon', label: 'Favicon', widget: 'image', required: false, hint: 'Icon browser tab (format .ico atau .png)' },
                  { name: 'tagline', label: 'Tagline', widget: 'string' },
                  { name: 'email', label: 'Email', widget: 'string' },
                  { name: 'phone', label: 'Phone', widget: 'string' },
                  { name: 'address', label: 'Address', widget: 'text' },
                  {
                    name: 'colors',
                    label: 'ðŸŽ¨ Brand Colors',
                    widget: 'object',
                    collapsed: false,
                    fields: [
                      { name: 'primary', label: 'Primary Color (Green)', widget: 'color', default: '#388f6b', hint: 'Warna utama untuk tombol, link, aksen' },
                      { name: 'gold', label: 'Gold Color', widget: 'color', default: '#FFD700', hint: 'Warna emas untuk aksen premium' },
                      { name: 'forest', label: 'Forest Green Color', widget: 'color', default: '#001B0E', hint: 'Warna hijau gelap' },
                      { name: 'dark', label: 'Dark Color', widget: 'color', default: '#1A1A1A', hint: 'Warna gelap untuk teks' },
                      { name: 'white', label: 'White Color', widget: 'color', default: '#FFFFFF', hint: 'Warna putih untuk background' }
                    ]
                  }
                ]
              },
              {
                name: 'social',
                label: 'Social Media Links',
                file: 'content/settings/social.json',
                fields: [
                  { name: 'instagram', label: 'Instagram URL', widget: 'string', required: false, hint: 'Contoh: https://instagram.com/luxiephoto' },
                  { name: 'facebook', label: 'Facebook URL', widget: 'string', required: false, hint: 'Contoh: https://facebook.com/luxiephoto' },
                  { name: 'youtube', label: 'YouTube URL', widget: 'string', required: false, hint: 'Contoh: https://youtube.com/@luxiephoto' },
                  { name: 'tiktok', label: 'TikTok URL', widget: 'string', required: false, hint: 'Contoh: https://tiktok.com/@luxiephoto' },
                  { name: 'twitter', label: 'Twitter/X URL', widget: 'string', required: false, hint: 'Contoh: https://twitter.com/luxiephoto' },
                  { name: 'pinterest', label: 'Pinterest URL', widget: 'string', required: false, hint: 'Contoh: https://pinterest.com/luxiephoto' },
                  { name: 'whatsapp', label: 'WhatsApp Number', widget: 'string', required: false, hint: 'Format: 628123456789 (tanpa + atau spasi)' },
                  { name: 'telegram', label: 'Telegram URL', widget: 'string', required: false, hint: 'Contoh: https://t.me/luxiephoto' },
                  { name: 'linkedin', label: 'LinkedIn URL', widget: 'string', required: false, hint: 'Contoh: https://linkedin.com/company/luxiephoto' }
                ]
              }
            ]
          },
          {
            name: 'hero',
            label: 'ðŸ  Hero Section',
            files: [
              {
                name: 'hero',
                label: 'Hero Content',
                file: 'content/hero/hero.json',
                fields: [
                  { name: 'subtitle', label: 'Subtitle', widget: 'string', default: 'Luxury Wedding Photography' },
                  { name: 'title', label: 'Title', widget: 'string', default: 'Capturing Your' },
                  { name: 'titleHighlight', label: 'Title Highlight', widget: 'string', default: 'Timeless Moments' },
                  { name: 'description', label: 'Description', widget: 'text' },
                  { name: 'ctaText', label: 'CTA Button Text', widget: 'string', default: 'View Our Work' },
                  { name: 'ctaSecondary', label: 'Secondary Button Text', widget: 'string', default: 'Get in Touch' },
                  { name: 'backgroundImages', label: 'Background Images', widget: 'list', field: { name: 'image', label: 'Image', widget: 'image' } },
                  { name: 'stats', label: 'Statistics', widget: 'list', fields: [
                    { name: 'number', label: 'Number', widget: 'string' },
                    { name: 'label', label: 'Label', widget: 'string' }
                  ]}
                ]
              }
            ]
          },
          {
            name: 'about',
            label: 'ðŸ‘¤ About Section',
            files: [
              {
                name: 'about',
                label: 'About Content',
                file: 'content/about/about.json',
                fields: [
                  { name: 'subtitle', label: 'Subtitle', widget: 'string', default: 'About Us' },
                  { name: 'decorativeText', label: 'Decorative Text', widget: 'string', default: 'Our Story' },
                  { name: 'title', label: 'Title', widget: 'string' },
                  { name: 'description', label: 'Description', widget: 'text' },
                  { name: 'images', label: 'About Images (4 images)', widget: 'list', max: 4, min: 4, field: { name: 'image', label: 'Image', widget: 'image' } },
                  { name: 'signature', label: 'Signature Name', widget: 'string' },
                  { name: 'experience', label: 'Experience Text', widget: 'string', default: '15+ Years of Excellence' },
                  { name: 'features', label: 'Features', widget: 'list', fields: [
                    { name: 'title', label: 'Title', widget: 'string' },
                    { name: 'description', label: 'Description', widget: 'text' }
                  ]}
                ]
              }
            ]
          },
          {
            name: 'portfolio',
            label: 'ðŸ“¸ Portfolio',
            folder: 'content/portfolio',
            create: true,
            slug: '{{slug}}',
            extension: 'json',
            format: 'json',
            fields: [
              { name: 'id', label: 'ID (auto)', widget: 'string', hint: 'ID unik (huruf kecil, tanpa spasi)' },
              { name: 'names', label: 'Couple Names', widget: 'string' },
              { name: 'category', label: 'Category', widget: 'select', options: ['Wedding', 'Pre-Wedding', 'Engagement', 'Garden Wedding', 'Beach Wedding', 'Rustic Wedding', 'Luxury Wedding', 'Traditional Wedding', 'Mountain Wedding', 'Castle Wedding'] },
              { name: 'location', label: 'Location', widget: 'string' },
              { name: 'description', label: 'Description', widget: 'text' },
              { name: 'image', label: 'Main Image', widget: 'image' },
              { name: 'date', label: 'Date', widget: 'datetime', required: false },
              { name: 'featured', label: 'Featured', widget: 'boolean', default: false },
              { name: 'gallery', label: 'Gallery Images', widget: 'list', required: false, field: { name: 'image', label: 'Image', widget: 'image' } }
            ]
          },
          {
            name: 'testimonials',
            label: 'ðŸ’¬ Testimonials',
            folder: 'content/testimonials',
            create: true,
            slug: '{{slug}}',
            extension: 'json',
            format: 'json',
            fields: [
              { name: 'id', label: 'ID (auto)', widget: 'string', hint: 'ID unik (huruf kecil, tanpa spasi)' },
              { name: 'names', label: 'Couple Names', widget: 'string' },
              { name: 'role', label: 'Role', widget: 'string', default: 'Bride & Groom' },
              { name: 'rating', label: 'Rating', widget: 'number', min: 1, max: 5, default: 5 },
              { name: 'text', label: 'Testimonial Text', widget: 'text' },
              { name: 'location', label: 'Location/Event', widget: 'string' },
              { name: 'avatar', label: 'Avatar Image', widget: 'image', required: false },
              { name: 'image', label: 'Wedding Image', widget: 'image', required: false }
            ]
          },
          {
            name: 'pricing',
            label: 'ðŸ’° Pricing Plans',
            folder: 'content/pricing',
            create: true,
            slug: '{{slug}}',
            extension: 'json',
            format: 'json',
            fields: [
              { name: 'id', label: 'ID (auto)', widget: 'string', hint: 'ID unik (huruf kecil, tanpa spasi)' },
              { name: 'name', label: 'Plan Name', widget: 'string' },
              { name: 'subtitle', label: 'Subtitle', widget: 'string' },
              { name: 'price', label: 'Price', widget: 'number' },
              { name: 'currency', label: 'Currency', widget: 'string', default: 'Rp' },
              { name: 'period', label: 'Period', widget: 'string', default: 'per event' },
              { name: 'popular', label: 'Popular Badge', widget: 'boolean', default: false },
              { name: 'order', label: 'Display Order', widget: 'number', default: 1 },
              { name: 'ctaText', label: 'Button Text', widget: 'string', default: 'Choose Plan' },
              { name: 'ctaLink', label: 'Button Link (URL)', widget: 'string', hint: 'Link tujuan saat tombol diklik. Contoh: https://wa.me/628xxx atau #contact', required: false },
              { name: 'features', label: 'Included Features', widget: 'list', field: { name: 'feature', label: 'Feature', widget: 'string' } },
              { name: 'notIncluded', label: 'Not Included', widget: 'list', required: false, field: { name: 'feature', label: 'Feature', widget: 'string' } }
            ]
          },
          {
            name: 'partners',
            label: 'ðŸ¤ Partners',
            folder: 'content/partners',
            create: true,
            slug: '{{slug}}',
            extension: 'json',
            format: 'json',
            fields: [
              { name: 'id', label: 'ID (auto)', widget: 'string', hint: 'ID unik (huruf kecil, tanpa spasi)' },
              { name: 'name', label: 'Partner Name', widget: 'string' },
              { name: 'logo', label: 'Logo', widget: 'image', required: false },
              { name: 'website', label: 'Website', widget: 'string', required: false },
              { name: 'order', label: 'Display Order', widget: 'number', default: 1 }
            ]
          },
          {
            name: 'contact',
            label: 'ðŸ“ž Contact Info',
            files: [
              {
                name: 'contact',
                label: 'Contact Information',
                file: 'content/contact/contact.json',
                fields: [
                  { name: 'subtitle', label: 'Section Subtitle', widget: 'string', default: 'Get In Touch', hint: 'Small text above title' },
                  { name: 'decorativeText', label: 'Decorative Text', widget: 'string', default: 'Contact', hint: 'Background decorative text' },
                  { name: 'title', label: 'Section Title', widget: 'string', default: "Let's Create Something Beautiful Together" },
                  { name: 'description', label: 'Section Description', widget: 'text', hint: 'Description text below title' },
                  { name: 'formTitle', label: 'Form Title', widget: 'string', default: 'Book a Session' },
                  { name: 'formDescription', label: 'Form Description', widget: 'string', default: "Fill out the form and we'll get back to you within 24 hours." },
                  { name: 'address', label: 'Address', widget: 'text' },
                  { name: 'phone', label: 'Phone', widget: 'string' },
                  { name: 'email', label: 'Email', widget: 'string' },
                  { name: 'website', label: 'Website', widget: 'string' },
                  { name: 'hours', label: 'Business Hours', widget: 'string' },
                  {
                    name: 'social',
                    label: 'Social Media',
                    widget: 'object',
                    fields: [
                      { name: 'instagram', label: 'Instagram', widget: 'string' },
                      { name: 'facebook', label: 'Facebook', widget: 'string' },
                      { name: 'pinterest', label: 'Pinterest', widget: 'string' },
                      { name: 'youtube', label: 'YouTube', widget: 'string' }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    });

    // Auto-trigger Vercel deploy after publish
    const VERCEL_DEPLOY_HOOK = 'https://api.vercel.com/v1/integrations/deploy/prj_oo826kAdlPkbAYbtun1qlYWkyyXR/bSZMpdYcq0';
    
    CMS.registerEventListener({
      name: 'postSave',
      handler: async ({ entry }) => {
        console.log('Content saved, triggering Vercel deploy...');
        try {
          const response = await fetch(VERCEL_DEPLOY_HOOK, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            }
          });
          if (response.ok) {
            console.log('Vercel deploy triggered successfully!');
            // Show notification to user
            setTimeout(() => {
              alert('âœ… Published! Website will update in ~1-2 minutes.');
            }, 500);
          } else {
            console.error('Failed to trigger deploy:', response.status);
          }
        } catch (error) {
          console.error('Error triggering deploy:', error);
        }
      }
    });
  </script>
</body>
</html>
